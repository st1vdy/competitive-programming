# 欧拉图

## 定义

- **欧拉回路**：通过图中每条边恰好一次的回路
- **欧拉通路**：通过图中每条边恰好一次的通路
- **欧拉图**：具有欧拉回路的图
- **半欧拉图**：具有欧拉通路但不具有欧拉回路的图



## 判别法

1. 无向图是**欧拉图**

   - 非零度顶点是连通的
   - 顶点的度数都是偶数

2. 无向图是**半欧拉图**

   - 非零度顶点是连通的

   - 顶点的度数都是偶数或恰有2个奇度数顶点

     > 一个简单的理解：欧拉回路上拆掉一条边就是一条欧拉通路，且这条通路的两个端点为奇度数顶点。

3. 有向图是**欧拉图**：

   - 非零度顶点是强连通的
   - 每个顶点的入度和出度相等

4. 有向图是**半欧拉图**

   - 非零度顶点是弱连通的

   - 至多一个顶点的出度与入度之差为1，至多一个顶点的入度与出度之差为1

   - 其他顶点的入度和出度相等

     > 一个简单的理解：有向图的欧拉回路上拆掉一条有向边，就会导致这条回路变成一条有向链路。



## Hierholzer算法构造欧拉回路

考虑这样一个性质：在一个欧拉图中，假设我们每次在图中取走一个环，这张图仍将是一个欧拉图（每个点的度数为偶数）。所以我们如果能够逐步插入这些环就能构造出一条欧拉回路。

Hierholzer's algorithm的核心思路就是：

1. 以DFS序遍历图 $G$，每次经过某一条边后，将这条边从图中删除。
2. 假设当前所在的点 $v$ 度数为 $0$，那就说明我们删除了点 $v$ 所在的最后一个环，而点 $v$ 就是这个环路的起点，我们将点 $v$ 加入欧拉回路序列中。
3. 重复上方操作直到结束。

该算法对于图上每条边只会遍历一次，因此时间复杂度为 $O(M)$。

> 构造欧拉路径只需要将Hierholzer算法的搜索起点设在某一个奇度数点上。



## 例题

### [UOJ117 欧拉回路](https://uoj.ac/problem/117)

模板题。

### [ABC286G Unique Walk](https://atcoder.jp/contests/abc286/tasks/abc286_g)

> 给定一个 $N$ 个点 $M$ 条边的无向图 $G$，和一个图 $G$ 中的边的子集 $S$，询问是否存在这样一条路径：恰好遍历子集 $S$ 中的所有边各一次，非子集 $S$ 中的边可以多次遍历。
>
> $N,M\le 2\times 10^5,|S|\le M$。

对所有不在子集 $S$ 中的边建立一个新的图 $G^\prime$，在 $G^\prime$ 中所有连通分量内部的点都可以相互到达（这些边都可以重复遍历，不用考虑它们对于题中路径的影响），因此我们可以将这些连通分量“缩点”，然后用子集 $S$ 中的边重新建图。

### [P1341 无序字母对](https://www.luogu.com.cn/problem/P1341)

可以把每一个字母看作点，每一个字母对看作边建图。字典序最小的欧拉回路/路径只需要在搜索前将邻接表按照字典序先排序即可。